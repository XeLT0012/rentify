<div class="dashboard-wrapper">
  <!-- Sidebar -->
  <aside class="sidebar">
    <h3>Rentify</h3>
    <ul>
      <li><a routerLink="/dashboard">ğŸ  Home</a></li>
      <li><a routerLink="/listings">ğŸ“¦ My Listings</a></li>
      <li><a routerLink="/add-listing">â• Add Listing</a></li>
      <li><a routerLink="/profile">ğŸ‘¤ Profile</a></li>
      <li><a routerLink="/bookings">ğŸ“‘ My Bookings</a></li> 
      <li><a (click)="logout()">ğŸšª Logout</a></li>
    </ul>
  </aside>

  <!-- Content -->
<main class="dashboard-content">
  <h2>Welcome, User ğŸ‘‹</h2>
  <p>Explore all available listings and connect with owners.</p>

  <!-- ğŸ” Search and Sort -->
  <div class="filter-bar">
    <input type="text" [(ngModel)]="searchTerm" (input)="applyFilters()" placeholder="Search by title or category">
    <select [(ngModel)]="sortOption" (change)="applyFilters()">
      <option value="priceLowToHigh">Price: Low to High</option>
      <option value="priceHighToLow">Price: High to Low</option>
      <option value="newest">Newest Listings</option>
    </select>
  </div>

  <!-- ğŸ—‚ Listing Grid -->
  <div class="listing-grid">
    <div class="listing-card" *ngFor="let item of filteredListings" (click)="openPopup(item)">
      <img [src]="'http://localhost:5000' + item.images[0]" alt="Listing image">
      <h3>{{ item.title }}</h3>
      <strong>â‚¹{{ item.price }}/day</strong>
      <p><em>{{ item.category }}</em></p>
    </div>
  </div>
</main>


  <!-- Fullscreen Popup -->
  <div class="listing-popup" *ngIf="selectedListing">
    <div class="popup-content">
      <div class="image-slider">
        <img [src]="'http://localhost:5000' + selectedListing.images[currentImageIndex]" alt="Listing image">
        <button (click)="prevImage($event)">â¬…</button>
        <button (click)="nextImage($event)">â¡</button>
      </div>

      <h3>{{ selectedListing.title }}</h3>
      <p>{{ selectedListing.description }}</p>
      <p><strong>Price:</strong> â‚¹{{ selectedListing.price }} /day</p>
      <p><strong>Category:</strong> {{ selectedListing.category }}</p>
      <p><strong>Condition:</strong> {{ selectedListing.condition }}</p>
      <p><strong>Location:</strong> {{ selectedListing.location }}</p>
      <p><strong>Available:</strong> {{ selectedListing.availableFrom | date }} to {{ selectedListing.availableUntil | date }}</p>
      <p><strong>Contact:</strong> {{ selectedListing.contactPreference }}</p>

      <div class="action-buttons">
        <button class="rent-btn" [routerLink]="['/booking', selectedListing._id]">Rent Now</button>
        <button class="cancel-btn" (click)="closePopup()">âœ– Cancel</button>
      </div>
    </div>
  </div>
</div>
